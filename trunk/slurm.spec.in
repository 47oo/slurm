Name: @PROJECT@
Version: @VERSION@
Release: @RELEASE@
Summary: Simple Linux Utility for Resource Management
License: GPL - Copyright (C) 2002 The Regents of the University of California.  Produced at Lawrence Livermore National Laboratory (cf, DISCLAIMER).  UCRL-CODE-2002-040.
Group: System Environment/Base
Source: %{name}-%{version}-%{release}.tgz
Requires: authd libreadline libpopt
BuildRoot: %{_tmppath}/%{name}-%{version}-%{release}

%define _with_authd 0
%define _with_elan 0
%define _with_totalview 0


%package devel
Summary: Devel package for SLURM.
Group: System Environment/Base
Requires: slurm


%description 
The common slurm package, which includes the base libraries, client utilitues for SLURM, slurmd, and slurmctld.
Slurmd  is the compute node daemon of Slurm. It monitors all tasks running on the compute node , accepts work (tasks), launches tasks, and kills running tasks upon request.
Slurmctld  is  the central management daemon of Slurm. It monitors all other Slurm daemons and resources, accepts work (jobs), and allocates resources to those jobs.

%description devel
Development package for SLURM.  This package includes the header files and static libraries.


%prep
%setup -n %{name}-%{version}-%{release}

%build
%if %{_with_elan}
	WITH_ELAN=--with-elan
%endif
%if %{_with_authd}
	WITH_AUTHD=--with-authd
%endif
%if %{_with_totalview}
	WITH_TOTALVIEW=--with-totalview
%endif


%configure --with-slurm-conf=/etc/slurm $WITHELAN $WITH_ELAN $WITH_AUTHD $WITH_TOTALVIEW
make

%install

%makeinstall
install -D -m755 etc/init.d.slurm $RPM_BUILD_ROOT/etc/rc.d/init.d/slurm

%clean
rm -rf $RPM_BUILD_ROOT

%files
# where does slurm.conf belong ??? Or should be throw it in the doc directory?
%defattr(-,root,root)
%doc README ChangeLog 
%attr(4755, root, root) %{_bindir}/scancel
%attr(4755, root, root) %{_bindir}/scontrol
%attr(4755, root, root) %{_bindir}/sinfo
%attr(4755, root, root) %{_bindir}/squeue
%attr(4755, root, root) %{_bindir}/srun 
%attr(4755, root, root) %{_sbindir}/slurmcltd
%attr(4755, root, root) %{_sbindir}/slurmd
%attr(4755, root, root) /etc/init.d/slurm
%{_libdir}/*.so
%{_mandir}/man1/*
%{_mandir}/man5/*
%{_mandir}/man8/*

%files devel
%defattr(-,root,root)
%{_prefix}/include/slurm.h
%{_libdir}/libslurm.a
%{_libdir}/libslurm.la
%{_mandir}/man3/*


%post

%changelog
* Sat Jan 26 2003 Joey Ekstrom <jcekstrom@llnl.gov> 
- Started spec file
-
